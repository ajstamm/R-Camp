---
title: "Day 2 - AM"
output: 
  blogdown::html_page: 
    toc: true
    toc_depth: 1
    highlight: tango
    css: css/camp_style.css
    number_sections: true
    self_contained: false
    fontsize: 18pt
    monofont: Source Code Pro
---

<link href="/rmarkdown-libs/font-awesome/css/all.css" rel="stylesheet" />
<link href="/rmarkdown-libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="/rmarkdown-libs/proj4/proj4.min.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>
  <link rel="stylesheet" href="css/camp_style.css" type="text/css" />

<div id="TOC">
<ul>
<li><a href="#review---new-project"><span class="toc-section-number">1</span> Review - New project</a></li>
<li><a href="#maps-with-sf"><span class="toc-section-number">2</span> <i class="fas fa-globe-africa"></i> Maps with <code>sf</code></a></li>
<li><a href="#leaflet-maps"><span class="toc-section-number">3</span> Leaflet maps</a></li>
<li><a href="#invasive-porg-survey---2023"><span class="toc-section-number">4</span> Invasive Porg Survey - 2023</a></li>
<li><a href="#dates-and-times-with-lubridate"><span class="toc-section-number">5</span> <i class="fa fa-calendar" aria-hidden="true"></i> Dates and times with <code>lubridate</code></a></li>
<li><a href="#pipe-things-together-a-b"><span class="toc-section-number">6</span> Pipe things together: <code>A %&gt;% B</code></a></li>
<li><a href="#finn-needs-us">Finn needs us!</a></li>
<li><a href="#jakku-re-visited"><span class="toc-section-number">7</span> Jakku re-visited</a></li>
<li><a href="#join-tables-with-left_join"><span class="toc-section-number">8</span> Join tables with <strong>left_join</strong></a></li>
</ul>
</div>

<style>
h1 .header-section-number {background: #62BE2C;}
hr {background: #62BE2C;}
</style>
<div id="good-morning-jedis" class="section level2 unnumbered">
<h2>Good morning, Jedis!</h2>
<hr class="hrlvl2">
<p><img src="../images/day2_bb8_sq.png" style="float: left; margin-right: 60px; margin-top: -10px;" width="260" /></p>
<div style="clear: both;">

</div>
</div>
<div id="review---new-project" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Review - New project</h1>
<hr>
<div id="new-data---new-project" class="section level2 unnumbered">
<h2>New data -&gt; New project!</h2>
<p>Below is an example workflow for an R project:</p>
<ol style="list-style-type: decimal">
<li>Create a new project</li>
<li>Read the data</li>
<li>Clean column names</li>
<li>Explore data
<ul>
<li>Plot the data</li>
</ul></li>
<li>Clean the data</li>
<li>View the data closer</li>
<li>Summarize the data</li>
<li>Save the results</li>
<li><strong>Share</strong> with friends</li>
</ol>
<div id="start-a-new-project" class="section level3 unnumbered">
<h3>0. Start a new project</h3>
<ul>
<li>Open a new project</li>
<li>Open a new R script</li>
<li>Create a <code>data</code> folder in your project directory</li>
<li>Copy your data to that folder</li>
</ul>
</div>
<div id="read-the-data" class="section level3 unnumbered">
<h3>1. Read the data</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the file from your data folder</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##air_data &lt;- read_csv(&quot;data/OZONE_samples_demo.csv&quot;)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the file from online</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>air_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/OZONE_samples_demo.csv&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">SITE</th>
<th align="left">Date</th>
<th align="right">OZONE</th>
<th align="right">TEMP_F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">27-137-7554</td>
<td align="left">2016-08-11</td>
<td align="right">19</td>
<td align="right">71.6</td>
</tr>
<tr class="even">
<td align="left">27-137-7001</td>
<td align="left">2017-10-30</td>
<td align="right">7</td>
<td align="right">41.0</td>
</tr>
<tr class="odd">
<td align="left">27-137-7001</td>
<td align="left">2017-09-17</td>
<td align="right">9</td>
<td align="right">67.4</td>
</tr>
<tr class="even">
<td align="left">27-137-7001</td>
<td align="left">2018-07-16</td>
<td align="right">10</td>
<td align="right">71.0</td>
</tr>
<tr class="odd">
<td align="left">27-137-7001</td>
<td align="left">2017-10-29</td>
<td align="right">5</td>
<td align="right">40.4</td>
</tr>
</tbody>
</table>
</div>
<div id="clean-column-names" class="section level3 unnumbered">
<h3>2. Clean column names</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Capital letters and spaces make things more difficult</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s clean them out</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>air_data <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(air_data)</span></code></pre></div>
</div>
</div>
<div id="explore-the-data" class="section level2 unnumbered">
<h2>3.1 Explore the data</h2>
<blockquote>
<p>Hint: <code>summary()</code>, <code>glimpse()</code>, <code>nrow()</code>, <code>names()</code></p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse shows the firstfew records of every column</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(air_data)</span></code></pre></div>
<pre><code>## Rows: 1,237
## Columns: 16
## $ site        &lt;chr&gt; &quot;27-137-7001&quot;, &quot;27-137-7001&quot;, &quot;27-137-7001&quot;, &quot;27-137-7001&quot;…
## $ date        &lt;date&gt; 2016-04-01, 2016-04-02, 2016-04-03, 2016-04-04, 2016-04-0…
## $ hour        &lt;dbl&gt; 6, 3, 3, 2, 1, 2, 0, 1, 3, 0, 1, 2, 1, 2, 4, 0, 1, 0, 4, 4…
## $ ozone       &lt;dbl&gt; 10.000, 14.000, 12.000, 13.000, 16.000, 0.018, 20.000, 14.…
## $ temp_f      &lt;dbl&gt; 24.2, 35.6, 28.4, 37.4, 42.8, 49.4, 44.0, 44.6, 53.0, 51.8…
## $ state_code  &lt;dbl&gt; 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27…
## $ county_code &lt;dbl&gt; 137, 137, 137, 137, 137, 137, 137, 137, 137, 137, 137, 137…
## $ site_num    &lt;dbl&gt; 7001, 7001, 7001, 7001, 7001, 7001, 7001, 7001, 7001, 7001…
## $ latitude    &lt;dbl&gt; 47.52336, 47.52336, 47.52336, 47.52336, 47.52336, 47.52336…
## $ longitude   &lt;dbl&gt; -92.5363, -92.5363, -92.5363, -92.5363, -92.5363, -92.5363…
## $ time        &lt;dttm&gt; 1899-12-31 06:00:00, 1899-12-31 03:00:00, 1899-12-31 03:0…
## $ parameter   &lt;dbl&gt; 88101, 88101, 88101, 88101, 88101, 88101, 88101, 88101, 88…
## $ year        &lt;dbl&gt; 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016…
## $ month       &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4…
## $ day         &lt;chr&gt; &quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;10&quot;…
## $ units       &lt;chr&gt; &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;PPM&quot;, &quot;PPB&quot;, &quot;PPB&quot;, &quot;P…</code></pre>
<div id="plot-the-data" class="section level3 unnumbered">
<h3>3.2 Plot the data</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(air_data, <span class="fu">aes</span>(<span class="at">x =</span> temp_f, <span class="at">y =</span> ozone)) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> site), <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="/page/Day2_AM_files/figure-html/view-1.png" width="1152" /></p>
</div>
<div id="clean-the-data" class="section level3 unnumbered">
<h3>4. Clean the data</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop values out of range</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>air_data <span class="ot">&lt;-</span> air_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ozone <span class="sc">&gt;</span> <span class="dv">0</span>, temp_f <span class="sc">&lt;</span> <span class="dv">120</span>) </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert all samples to PPB</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>air_data <span class="ot">&lt;-</span> air_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">OZONE =</span> <span class="fu">ifelse</span>(units <span class="sc">==</span> <span class="st">&quot;PPM&quot;</span>, ozone <span class="sc">*</span> <span class="dv">1000</span>, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                  ozone)) </span></code></pre></div>
</div>
<div id="view-the-data-closer" class="section level3 unnumbered">
<h3>5. View the data <strong>closer</strong></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(air_data, <span class="fu">aes</span>(<span class="at">x =</span> temp_f, <span class="at">y =</span> ozone)) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ozone tends to increase with temperature&quot;</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Observations for 2015-2017&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">&quot;Source: MPCA air monitoring network&quot;</span>)</span></code></pre></div>
<p><img src="/page/Day2_AM_files/figure-html/unnamed-chunk-3-1.png" width="1152" /></p>
<blockquote>
<p>Keep exploring…</p>
</blockquote>
</div>
<div id="summarize-the-data" class="section level3 unnumbered">
<h3>6. Summarize the data</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>air_data <span class="ot">&lt;-</span> air_data <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(site, year) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">summarize</span>(<span class="at">avg_ozone =</span> <span class="fu">mean</span>(ozone) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">avg_temp  =</span> <span class="fu">mean</span>(temp_f) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">site</th>
<th align="right">year</th>
<th align="right">avg_ozone</th>
<th align="right">avg_temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">27-137-7001</td>
<td align="right">2016</td>
<td align="right">11.01</td>
<td align="right">60.74</td>
</tr>
<tr class="even">
<td align="left">27-137-7001</td>
<td align="right">2017</td>
<td align="right">11.26</td>
<td align="right">60.66</td>
</tr>
<tr class="odd">
<td align="left">27-137-7001</td>
<td align="right">2018</td>
<td align="right">11.54</td>
<td align="right">60.59</td>
</tr>
<tr class="even">
<td align="left">27-137-7554</td>
<td align="right">2016</td>
<td align="right">12.23</td>
<td align="right">61.23</td>
</tr>
<tr class="odd">
<td align="left">27-137-7554</td>
<td align="right">2017</td>
<td align="right">11.81</td>
<td align="right">60.98</td>
</tr>
<tr class="even">
<td align="left">27-137-7554</td>
<td align="right">2018</td>
<td align="right">12.87</td>
<td align="right">61.02</td>
</tr>
</tbody>
</table>
</div>
<div id="save-the-results" class="section level3 unnumbered">
<h3>7. Save the results</h3>
<p><strong>Save the data table</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(air_data, <span class="st">&quot;results/2015_2017_ozone_summary.csv&quot;</span>)</span></code></pre></div>
<p><br></p>
</div>
</div>
<div id="porg-review" class="section level2 unnumbered">
<h2>Porg review</h2>
<hr class="hrlvl2">
<p>The <em>poggle</em> of porgs has returned to help review the <code>dplyr</code> functions. Follow along by reading the <strong>porg</strong> data from the URL below.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>porgs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.com/data/porg_data.csv&quot;</span>)</span></code></pre></div>
<p><br></p>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="porgs-tab" data-toggle="tab" href="#porgs" role="tab" aria-controls="porgs" aria-selected="true"> porgs </a>
</li>
<li class="nav-item">
<a class="nav-link" id="select-tab" data-toggle="tab" href="#select" role="tab" aria-controls="select" aria-selected="false"> <code>select</code> </a>
</li>
<li class="nav-item">
<a class="nav-link" id="arrange-tab" data-toggle="tab" href="#arrange" role="tab" aria-controls="arrange" aria-selected="false"> <code>arrange</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="filter-tab" data-toggle="tab" href="#filter" role="tab" aria-controls="filter" aria-selected="false"> <code>filter</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="mutate3-tab" data-toggle="tab" href="#mutate3" role="tab" aria-controls="mutate3" aria-selected="false"> <code>mutate</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="summarize-tab" data-toggle="tab" href="#summarize" role="tab" aria-controls="summarize" aria-selected="false"> <code>summarize</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="group_by-tab" data-toggle="tab" href="#group_by" role="tab" aria-controls="group_by" aria-selected="false"> <code>group_by</code></a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="porgs" class="tab-pane fade active in" role="tabpanel" aria-labelledby="porgs-tab">
<img src="../images/porgs/porgs_tbl.png" style="width: 85%;" /> <br><br>
</div>
<div id="select" class="tab-pane fade" role="tabpanel" aria-labelledby="select-tab">
<img src="../images/porgs/select_card.png" style="width: 90%;" /> <br><br> <img src="../images/porgs/select_drop.png" style="width: 65%;" /> <img src="../images/porgs/select_drop_tbl.png" style="width: 80%; margin-left: 5%; margin-top: 12px;" /> <br><br>
</div>
<div id="arrange" class="tab-pane fade" role="tabpanel" aria-labelledby="arrange-tab">
<img src="../images/porgs/arrange.png" style="width: 65%;" /> <img src="../images/porgs/arrange_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/arrange_desc.png" style="width: 57%;" /> <img src="../images/porgs/arrange_tbl_desc.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br>
</div>
<div id="filter" class="tab-pane fade" role="tabpanel" aria-labelledby="filter-tab">
<img src="../images/porgs/filter.png" style="width: 65%;" /> <img src="../images/porgs/filter_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/filter2.png" style="width: 75%;" /> <img src="../images/porgs/filter2_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br>
</div>
<div id="mutate3" class="tab-pane fade" role="tabpanel" aria-labelledby="mutate3-tab">
<img src="../images/porgs/mutate_card.png" style="width: 88%;" /> <br><br>
</div>
<div id="summarize" class="tab-pane fade" role="tabpanel" aria-labelledby="summarize-tab">
<img src="../images/porgs/summarize_card.png" style="width: 88%;" /> <br><br>
</div>
<div id="group_by" class="tab-pane fade" role="tabpanel" aria-labelledby="group_by-tab">
<img src="../images/porgs/groupby_card.png" style="width: 92%;" /> <br><br>
</div>
</div>
<p><br></p>
</div>
<div id="welcome-to-endor" class="section level2 unnumbered">
<h2>Welcome to Endor!</h2>
<hr class="hrlvl2">
<p><img src="https://mn-r.netlify.com/images/planet_endor.jpg" style="width: 75%; margin-top: -4px; margin-left: 11%;" /></p>
</div>
<div id="but-wait" class="section level2 unnumbered">
<h2>But wait…</h2>
<hr class="hrlvl2">
<p>The Ewoks say it’s unsafe to land. Booo… Sounds like the Empire is checking all ships for licenses.</p>
<p>Lucky for us there is some good news. They say for a small ship like ours, it is possible to land undetected. But we’ll have to put down right-dab in the middle of the 3 northern outposts.</p>
<p><br></p>
<blockquote>
<p>Are you up for a challenge data droid?</p>
</blockquote>
<p><br></p>
<p>Either way, let’s make a map to see what we’re up against. To help, our comrades sent along the coordinates of the Empire’s outposts. Guess what the first step is? That’s right. Time to add a new package.</p>
</div>
</div>
<div id="maps-with-sf" class="section level1" number="2">
<h1><span class="header-section-number">2</span> <i class="fas fa-globe-africa"></i> Maps with <code>sf</code></h1>
<hr>
<div id="the-sf-package." class="section level3 unnumbered">
<h3>The <code>sf</code> package.</h3>
<p><img src="../images/sf.gif" style="width: 21%; float: left; margin-right: 30px; margin-top: 8px; margin-bottom: 12px;" /></p>
<p><br></p>
<p>SF makes maps and spatial analysis in R feel like you’re working with regular table data. It’s full of spatial functions for calculating distances and areas, adding buffers around points, and all the handy dplyr toolbox functions will work as well.</p>
<p>Let’s get it!</p>
<div style="clear: both;">

</div>
</div>
<div id="install-sf" class="section level3 unnumbered">
<h3>Install <code>sf</code></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
</div>
<div id="reading-coordinates" class="section level2 unnumbered">
<h2>Reading coordinates</h2>
<p>To read coordinates stored in a spreadsheet or CSV, we can read them into R with our usual friends <code>read_csv()</code> and <code>read_excel()</code>.</p>
<div id="however" class="section level3 unnumbered">
<h3>However</h3>
<p>Endor still uses ancient data systems and their spatial data is in a format known as <strong>shapefiles</strong>.
But don’t worry, we can do it all with SF’s <code>st_read()</code> function.</p>
</div>
<div id="get-the-shapefile" class="section level3 unnumbered">
<h3>Get the shapefile</h3>
<ol style="list-style-type: decimal">
<li>Download the data.
<ul>
<li><a href="https://github.com/MPCA-data/R-Camp/raw/main/public/data/endor_outposts.zip"><span class="btn_code_blue" style="margin-bottom: 10px; margin-top: 12px;"> <strong>DOWNLOAD </strong> </span></a> - Get the Endor outpost coordinates</li>
</ul></li>
<li>Create a new folder called <code>data</code> in your project folder.</li>
<li>Move the downloaded <code>endor_outposts.zip</code> file into the folder.</li>
<li>Right click on the file &gt; Select <code>Extract All...</code> &gt;&gt; Click <code>Extract</code>.</li>
<li>You’re ready for <code>st_read()</code>.</li>
</ol>
</div>
</div>
<div id="give-it-a-try" class="section level2 unnumbered">
<h2>Give it a try</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>outposts <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/endor_outposts/endor_outposts.shp&quot;</span>)</span></code></pre></div>
<p><br></p>
<div id="take-a-look" class="section level3 unnumbered">
<h3>Take a look</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>outposts</span></code></pre></div>
<pre><code>## Simple feature collection with 3 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -1838045 ymin: 4374497 xmax: -1830923 ymax: 4383353
## Projected CRS: NAD83 / UTM zone 15N
## # A tibble: 3 × 4
##   ID        x_utm    y_utm           geometry
##   &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;POINT [m]&gt;
## 1 1NO   -1831087. 4383353. (-1831087 4383353)
## 2 1NL   -1830923. 4374497. (-1830923 4374497)
## 3 3NB   -1838045. 4378301. (-1838045 4378301)</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(outposts)</span></code></pre></div>
<pre><code>## Rows: 3
## Columns: 4
## $ ID       &lt;chr&gt; &quot;1NO&quot;, &quot;1NL&quot;, &quot;3NB&quot;
## $ x_utm    &lt;dbl&gt; -1831087, -1830923, -1838045
## $ y_utm    &lt;dbl&gt; 4383353, 4374497, 4378301
## $ geometry &lt;POINT [m]&gt; POINT (-1831087 4383353), POINT (-1830923 4374497), POINT (-1…</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_coordinates</span>(outposts)</span></code></pre></div>
<pre><code>##          X       Y
## 1 -1831087 4383353
## 2 -1830923 4374497
## 3 -1838045 4378301</code></pre>
<p><br></p>
<p>To make a quick map, use ggplot and add <code>+ geom_sf()</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outposts) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) </span></code></pre></div>
<p><img src="/page/Day2_AM_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>
<p><br></p>
<p><strong>Try running the function <code>st_distance()</code> on your outposts.</strong></p>
<blockquote>
<p>What do you get?</p>
</blockquote>
<p><br></p>
</div>
</div>
<div id="wheres-the-center-point" class="section level2 unnumbered">
<h2>Where’s the center point?</h2>
<div id="the-st_centroid-function-can-find-it" class="section level3 unnumbered">
<h3>The <code>st_centroid()</code> function can find it:</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First- Combine all outposts into one object</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>outposts_combined <span class="ot">&lt;-</span> <span class="fu">st_combine</span>(outposts) </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then - get the objects center              </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>land_pad <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(outposts_combined)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View center coordinates</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>land_pad</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">POINT (-1833352 4378717)</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="we-found-it" class="section level3 unnumbered">
<h3>We found it!</h3>
<p>That’s fantastic.</p>
<p>But there’s one more piece of bad news… These coordintes are in a different Coordinate Reference System (CRS) than our ship needs. <strong>CRS</strong> is a real thing!</p>
<p>The Endor outposts are currently in the UTM coordinate system, but our ship requires coordinates in <strong>WGS84 Lat/Lng</strong>.</p>
<ul>
<li>These coordinates generally look like this <code>(45.6, -93.12)</code>.</li>
<li>See <a href="https://epsg.io/4326" class="uri">https://epsg.io/4326</a> for more details.</li>
</ul>
<p>The <strong>SF</strong> package will help with coordinate conversions as well. Try using <code>st_transform()</code> and set the crs argument to: <code>crs = 4326</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform outposts</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>outposts <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(outposts, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform landing pad</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>land_pad <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(land_pad, <span class="at">crs =</span> <span class="dv">4326</span>)</span></code></pre></div>
</div>
<div id="wonderful" class="section level3 unnumbered">
<h3>Wonderful!</h3>
<p><br></p>
<div class="note">
<h3>
<i class="fas fa-heart" aria-hidden="true" style="color: hotpink"></i> Minnesota
</h3>
<p>In Minnesota, you’ll often receive coordinates with the CRS set to <em>UTM Zone 15N</em>. This is CRS number <code>26915</code>. See <a href="https://epsg.io/26915" class="uri">https://epsg.io/26915</a>.</p>
</div>
<p><br></p>
<div class="well">
<p>We’re going to need to be very precise to land perfectly in between these outposts. To make our captain really happy, let’s put this all in an interactive zoomable map. For interactive maps we use <strong>leaflet</strong>.</p>
</div>
</div>
</div>
</div>
<div id="leaflet-maps" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Leaflet maps</h1>
<hr>
<div id="the-leaflet-package." class="section level3 unnumbered">
<h3>The <code>leaflet</code> package.</h3>
<p><img src="../images/leaflet.png" style="width: 37%; float: left; margin-right: 30px; margin-top: 8px; margin-bottom: 12px;" /></p>
<p>Leaflet makes interactive maps easy and you build them up in layers similar to a ggplot.</p>
<br>
<div style="clear: both;">

</div>
</div>
<div id="install-leaflet" class="section level3 unnumbered">
<h3>Install <code>leaflet</code></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;leaflet&quot;</span>)</span></code></pre></div>
</div>
<div id="maps-that-zoom" class="section level2 unnumbered">
<h2>Maps that zoom</h2>
<p>Leaflet builds map with layers similar to ggplot, but instead of adding things with the <code>+</code>, leaflet adds new layers with the <code>%&gt;%</code> (“the pipe”).</p>
<div id="start-with-the-outpost-coordinates" class="section level3 unnumbered">
<h3>1. Start with the outpost coordinates</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(outposts) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircles</span>(<span class="at">radius =</span> <span class="dv">250</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>()</span></code></pre></div>
<div id="htmlwidget-1" style="width:864px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addCircles","args":[[36.6552,36.583748,36.5979],[-118.8469,-118.8195,-118.90218],250,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}],"limits":{"lat":[36.583748,36.6552],"lng":[-118.90218,-118.8195]}},"evals":[],"jsHooks":[]}</script>
<p><br></p>
</div>
<div id="add-the-landing-site" class="section level3 unnumbered">
<h3>2. Add the landing site</h3>
<p><em>Fingers crossed it’s in the middle….</em></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(outposts) <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircles</span>(<span class="at">radius =</span> <span class="dv">300</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">data  =</span> land_pad)  <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><br></p>
</div>
<div id="add-labels" class="section level3 unnumbered">
<h3>3. Add labels</h3>
<p><em>Try hovering over one of the outposts to see its label.</em></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(outposts) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircles</span>(<span class="at">radius =</span> <span class="dv">300</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="sc">~</span>ID) <span class="sc">%&gt;%</span>   <span class="co">#&lt;&lt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">data  =</span> land_pad,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="st">&quot;Land HERE!&quot;</span>,  <span class="co">#&lt;&lt;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="at">noHide =</span> T))  <span class="co">#&lt;&lt;</span></span></code></pre></div>
<div id="htmlwidget-2" style="width:864px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addCircles","args":[[36.6552,36.583748,36.5979],[-118.8469,-118.8195,-118.90218],300,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,["1NO","1NL","3NB"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[36.612287517514,-118.856192682743,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,"Land HERE!",{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[36.583748,36.6552],"lng":[-118.90218,-118.8195]}},"evals":[],"jsHooks":[]}</script>
<p><br></p>
</div>
<div id="explore" class="section level3 unnumbered tip">
<h3><i class="fa fa-user-astronaut" aria-hidden="true" style="color: green"></i> Explore!</h3>
<p>News just came in that the outposts will soon be upgrading their <strong>radar</strong> to detect ships up to <code>4,200 meters</code> away. Will that be a problem?</p>
<p><strong>Steps</strong></p>
<ol style="list-style-type: decimal">
<li>Use <code>st_buffer()</code> to add a 4,200 meter ring around each outpost.
<ul>
<li><code>outposts_new &lt;- st_buffer(outposts, dist = 4200)</code></li>
</ul></li>
<li>Then add a layer to the leaflet map using <code>addPolygons()</code> with <code>data = outposts_new</code>.</li>
<li>You can drop the <code>radius = 300</code> argument.</li>
</ol>
<details>
<summary class="btn_code">
<em>Show code</em>
</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>outposts_new <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(outposts, <span class="at">dist =</span> <span class="dv">4200</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(outposts) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircles</span>(<span class="at">label =</span> <span class="sc">~</span>ID) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">data  =</span> land_pad,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">label =</span> <span class="st">&quot;Land HERE???&quot;</span>,  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="at">noHide =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addPolygons</span>(<span class="at">data =</span> outposts_new,    <span class="co">#&lt;&lt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">fillColor =</span> <span class="st">&quot;yellow&quot;</span>)   <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><br></p>
</details>
<blockquote>
<p><strong>Will our landing spot still be safe?</strong></p>
</blockquote>
<p><br></p>
</div>
</div>
<div id="wow" class="section level2 unnumbered">
<h2>Wow!</h2>
<p>You’re on 🔥 fire data droid. Let’s sit here a minute to cool down…</p>
<p>Ok, now let’s go land on that planet before we get stuck up here with permanent space legs.</p>
</div>
</div>
<div id="invasive-porg-survey---2023" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Invasive Porg Survey - 2023</h1>
<hr>
<p>The Ewoks need our help. There’s porgs <strong>EVERYWHERE!</strong></p>
<p><img src="../images/porgs_bb8_2.jpg" style="margin-top: 0px;"></p>
<p>They have been spreading across the galaxy, hitching rides on unsuspecting ships. They’re so cute people hate to admit it, but they are starting to become a nuisance. To get a grasp on the problem the Ewoks are doing the first ever porg survey. And they need your help scheduling the <strong>survey dates</strong>.</p>
</div>
<div id="dates-and-times-with-lubridate" class="section level1" number="5">
<h1><span class="header-section-number">5</span> <i class="fa fa-calendar" aria-hidden="true"></i> Dates and times with <code>lubridate</code></h1>
<hr>
<div id="the-lubridate-package." class="section level3 unnumbered">
<h3>The <code>lubridate</code> package.</h3>
<p><img src="../images/lubridate.png" style="width: 21%; float: left; margin-right: 30px; margin-top: 8px; margin-bottom: 12px;" /></p>
<p><br></p>
<p>It’s about time! Lubridate makes working with dates much easier.</p>
<p>We can find how much time has elapsed, add or subtract days, and find seasonal and day of the week averages.</p>
<p><br></p>
<div style="clear: both;">

</div>
</div>
<div id="install-lubridate" class="section level3 unnumbered">
<h3>Install <code>lubridate</code></h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;lubridate&quot;</span>)</span></code></pre></div>
<p><br>
<strong>View the date cheatsheet <a href="https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf">HERE</a></strong>.</p>
<p>It’s a great reference when you need to manipulate dates or timezones in your data.</p>
</div>
<div id="menu-of-date-functions" class="section level2 unnumbered">
<h2>Menu of date functions</h2>
<hr class="hrlvl2">
<div id="convert-text-to-a-date" class="section level4 unnumbered">
<h4>Convert text to a <code>DATE</code></h4>
<table>
<colgroup>
<col width="5%" />
<col width="94%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th align="left">Order of date elements</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mdy()</code></td>
<td align="left">Month-Day-Year :: <code>05-18-2019</code> or <code>05/18/2019</code></td>
</tr>
<tr class="even">
<td><code>dmy()</code></td>
<td align="left">Day-Month-Year (Euro dates) :: <code>18-05-2019</code> or <code>18/05/2019</code></td>
</tr>
<tr class="odd">
<td><code>ymd()</code></td>
<td align="left">Year-Month-Day (science dates) :: <code>2019-05-18</code> or <code>2019/05/18</code></td>
</tr>
<tr class="even">
<td><code>ymd_hm()</code></td>
<td align="left">Year-Month-Day Hour:Minutes :: <code>2019-05-18 8:35 AM</code></td>
</tr>
<tr class="odd">
<td><code>ymd_hms()</code></td>
<td align="left">Year-Month-Day Hour:Minutes:Seconds :: <code>2019-05-18 8:35:22 AM</code></td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="get-specific-date-parts-eg.-the-year-month-day" class="section level4 unnumbered">
<h4>Get specific date parts (eg. the year, month, day… )</h4>
<table>
<colgroup>
<col width="5%" />
<col width="94%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th align="left">Date element</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>year()</code></td>
<td align="left">Year</td>
</tr>
<tr class="even">
<td><code>month()</code></td>
<td align="left">Month as <em>1,2,3</em>; For <em>Jan, Feb, Mar</em> use <code>label=TRUE</code></td>
</tr>
<tr class="odd">
<td><code>week()</code></td>
<td align="left">Week of the year</td>
</tr>
<tr class="even">
<td><code>day()</code></td>
<td align="left">Day of the month</td>
</tr>
<tr class="odd">
<td><code>wday()</code></td>
<td align="left">Day of the week as <em>1,2,3</em>; For <em>Sun, Mon, Tue</em> use <code>label=TRUE</code></td>
</tr>
<tr class="even">
<td><em>- Time -</em></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td><code>hour()</code></td>
<td align="left">Hour of the day <em>(24hr)</em></td>
</tr>
<tr class="even">
<td><code>minute()</code></td>
<td align="left">Minutes</td>
</tr>
<tr class="odd">
<td><code>second()</code></td>
<td align="left">Seconds</td>
</tr>
<tr class="even">
<td><code>tz()</code></td>
<td align="left">Time zone</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div class="note">
<div id="clean-the-dates" class="section level3 unnumbered">
<h3><i class="fa fa-broom" aria-hidden="true"></i> Clean the dates</h3>
</div>
<div id="real-world-examples" class="section level3 unnumbered">
<h3>Real world examples</h3>
<p>Does your date column look like one of these?</p>
<p>Here’s the <code>lubridate</code> function to convert the column to a date.</p>
<table>
<colgroup>
<col width="23%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th>Format</th>
<th align="left">Function to use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“05/18/2019”</td>
<td align="left"><code>mdy(date_column)</code></td>
</tr>
<tr class="even">
<td>“May 18, 2019”</td>
<td align="left"><code>mdy(date_column)</code></td>
</tr>
<tr class="odd">
<td>“05/18/2019 8:00 CDT”</td>
<td align="left"><code>mdy_hm(date_column, tz = "US/Central")</code></td>
</tr>
<tr class="even">
<td>“05/18/2019 11:05:32 PDT”</td>
<td align="left"><code>mdy_hms(date_column, tz = "US/Pacific")</code></td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>European dates</strong></p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th align="left">Function to use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“30.05.2019”</td>
<td align="left"><code>dmy(date_column)</code></td>
</tr>
<tr class="even">
<td>“30-05-2019”</td>
<td align="left"><code>dmy(date_column)</code></td>
</tr>
<tr class="odd">
<td>“30/05/2019”</td>
<td align="left"><code>dmy(date_column)</code></td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Simple number dates</strong></p>
<table>
<thead>
<tr class="header">
<th>Format</th>
<th align="left">Function to use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“20190518”</td>
<td align="left"><code>ymd(sample_date)</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<div id="survey-objective" class="section level3 unnumbered">
<h3>Survey objective</h3>
<div class="well">
<ul>
<li>The Ewoks have asked you help organize their Porg survey for the season from May to October.</li>
<li>In 2023, the Ewoks would like to perform a porg count once a week from May to October.</li>
<li>They have enough volunteers to run the survey at two locations across their forest
<ul>
<li>Sites: <code>c("Bright Tree", "Fern Gully")</code></li>
</ul></li>
</ul>
</div>
<p><br></p>
<p>Let’s generate the full list of dates during this time span using the sequence date function: <code>seq.Date()</code></p>
<p><br></p>
<p>Run the code below to create a date for every possible day of the survey.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">&quot;2023-05-01&quot;</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>end_date   <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">&quot;2023-10-31&quot;</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence from start to end, counting by 1 day intervals</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>survey_dates <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> start_date, </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">to =</span> end_date, </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="st">&quot;day&quot;</span>)</span></code></pre></div>
<p><br></p>
</div>
<div id="how-many-days-will-the-survey-run" class="section level3 unnumbered">
<h3>How many days will the survey run?</h3>
<details>
<summary class="btn_code">
Show answer
</summary>
<blockquote>
<p><em>184 days</em></p>
</blockquote>
</details>
<p><br></p>
</div>
<div id="put-the-dates-in-a-dataframe" class="section level3 unnumbered">
<h3>Put the dates in a dataframe</h3>
<p><br></p>
<blockquote>
<p>Remember how to make a dataframe?</p>
</blockquote>
<div id="heres-a-reminder" class="section level4 unnumbered">
<h4>Here’s a reminder:</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">count_date =</span> survey_dates)</span></code></pre></div>
</div>
</div>
<div id="great" class="section level3 unnumbered">
<h3>Great!</h3>
</div>
</div>
<div id="scheduling-weekdays" class="section level2 unnumbered">
<h2>1. Scheduling weekdays</h2>
<p><img src="https://cdn.iconscout.com/icon/free/png-128/calendar-1562-518053.png" align=right /></p>
<p>Ewoks are very busy. Unfortunately, they only have one day per week when they can volunteer.</p>
<p>Here is the weekday when volunteers are available at each location:</p>
<ul>
<li>Bright Tree: <code>Thursdays</code></li>
<li>Fern Gully: <code>Fridays</code></li>
</ul>
<p><br></p>
<p>We can use the <code>seq.Date()</code> function and the option to step <code>by = "week"</code> to
generate the survey dates for each site. But we need to know which day to start from.</p>
<p><br></p>
<blockquote>
<h3 id="when-is-the-first-thursday-in-may-of-2023" class="unnumbered">when is the first Thursday in May of 2023?</h3>
</blockquote>
<p>For that, we can use the <code>wday()</code>, the “weekday” function.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wday tells you the day of week (Sun, Mon, etc..) for a specific date</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(<span class="fu">ymd</span>(<span class="st">&#39;2023-05-01&#39;</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] Monday
## 7 Levels: Sunday &lt; Monday &lt; Tuesday &lt; Wednesday &lt; Thursday &lt; ... &lt; Saturday</code></pre>
<p><br></p>
<p>So the <code>1st</code> of May will be a Monday. That means…. <strong>May the 4th</strong> will be a Thursday. Perfect! That’s my favorite day.</p>
<div id="mutate-to-the-rescue" class="section level3 unnumbered">
<h3>Mutate to the rescue</h3>
<p>We really don’t want to check every date one by one do we?</p>
<p>Let’s add a new <code>week_day</code> column to our survey table that checks ALL the dates ALL at once. To add a new column we call our friend <code>mutate()</code>.</p>
<p>Complete the code below to add a <code>week_day</code> column.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">mutate</span>(survey, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">week_day =</span> <span class="fu">wday</span>( ________ , <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p><br></p>
</div>
<div id="filter-week-days" class="section level3 unnumbered">
<h3><code>filter()</code> week days</h3>
<p>Filter allows us to pick out only the days of the week we want.</p>
<p>Split the schedule in two by filtering the survey to only the week day needed for each site:</p>
<ul>
<li><code>Thursday</code> for Bright Tree</li>
<li><code>Friday</code> for Fern Gully</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bright_dates <span class="ot">&lt;-</span> <span class="fu">filter</span>(survey, week_day <span class="sc">==</span>  ________ )</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>fern_dates   <span class="ot">&lt;-</span> <span class="fu">filter</span>(survey, week_day <span class="sc">==</span>  ________ )</span></code></pre></div>
<details>
<summary class="btn_code">
Show code
</summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>bright_dates <span class="ot">&lt;-</span> <span class="fu">filter</span>(survey, week_day <span class="sc">==</span>  <span class="st">&quot;Thursday&quot;</span> )</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>fern_dates   <span class="ot">&lt;-</span> <span class="fu">filter</span>(survey, week_day <span class="sc">==</span>  <span class="st">&quot;Friday&quot;</span> )</span></code></pre></div>
</details>
<p><br></p>
<p><strong>How many survey dates are at each site?</strong></p>
<blockquote>
<p><em>Hint: It’s less than 50.</em></p>
</blockquote>
<details>
<summary class="btn_code">
Show answer
</summary>
<blockquote>
<p><strong>26 survey days</strong></p>
</blockquote>
</details>
<p><br></p>
</div>
</div>
<div id="particular-date-formats" class="section level2 unnumbered">
<h2>2. Particular date formats</h2>
<p><img align="left" src="../images/dwight.png" style="margin-right: 14px;"></p>
<p>Oh no! Each survey site has a very-very particular <strong>Assistant to the Regional Manager</strong>. And they are demanding a very <strong>specific</strong> date format for their work schedules.</p>
<p><br></p>
<p>Before you send off the survey dates, you’ll need to adjust the dates to match the requested formats below.</p>
<p><strong>Preferred date formats</strong></p>
<ul>
<li>Bright Tree: <code>5-11-2023</code></li>
<li>Fern Gully: <code>May 12, 2023</code></li>
</ul>
<p><br></p>
<p>Use <code>format(count_date, ...)</code> and the date expressions below to format the schedule for each region accordingly.</p>
<blockquote>
<p>For example: <code>format(count_date, "%b, %Y")</code> prints the date as <code>Aug, 2023</code>.</p>
<ul>
<li><code>%b</code> stands for 3-letter month abbreviation</li>
<li><code>%Y%</code> stands for the full 4 digit year</li>
</ul>
</blockquote>
<div id="date-parts" class="section level3 unnumbered">
<h3>Date parts</h3>
<table>
<thead>
<tr class="header">
<th align="left">Expression</th>
<th align="left">Description</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>%Y</code></td>
<td align="left">Year (4 digit)</td>
<td align="left">2023</td>
</tr>
<tr class="even">
<td align="left"><code>%y</code></td>
<td align="left">Year (2 digit)</td>
<td align="left">21</td>
</tr>
<tr class="odd">
<td align="left"><code>%B</code></td>
<td align="left">Month (full name)</td>
<td align="left">December</td>
</tr>
<tr class="even">
<td align="left"><code>%b</code></td>
<td align="left">Month (abbreviated)</td>
<td align="left">Dec</td>
</tr>
<tr class="odd">
<td align="left"><code>%m</code></td>
<td align="left">Month (decimal number)</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left"><code>%d</code></td>
<td align="left">Day of the month (decimal number)</td>
<td align="left">30</td>
</tr>
</tbody>
</table>
</div>
<div id="time-parts" class="section level3 unnumbered">
<h3>Time parts</h3>
<table>
<thead>
<tr class="header">
<th align="left">Expression</th>
<th align="left">Description</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>%H</code></td>
<td align="left">Hour</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left"><code>%M</code></td>
<td align="left">Minute</td>
<td align="left">13</td>
</tr>
<tr class="odd">
<td align="left"><code>%S</code></td>
<td align="left">Second</td>
<td align="left">35</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Use <code>mutate()</code> to update the <strong>week_day</strong> column in both site schedules.</p>
<p><strong>Here’s a start</strong></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set date format to 5-11-2023</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>bright_dates <span class="ot">&lt;-</span> <span class="fu">mutate</span>(bright_dates, <span class="at">count_date =</span> <span class="fu">format</span>(count_date, _______  ))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set date format to May 12, 2023</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>fern_dates <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fern_dates, <span class="at">count_date =</span> <span class="fu">format</span>(count_date, _______ ))</span></code></pre></div>
<details>
<summary class="btn_code">
Show code
</summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set date format to 5-11-2023</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>bright_dates <span class="ot">&lt;-</span> <span class="fu">mutate</span>(bright_dates, <span class="at">count_date =</span> <span class="fu">format</span>(count_date, <span class="st">&quot;%m-%d-%Y&quot;</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set date format to May 12, 2023</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>fern_dates <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fern_dates, <span class="at">count_date =</span> <span class="fu">format</span>(count_date, <span class="st">&quot;%b %d, %Y&quot;</span>))</span></code></pre></div>
</details>
</div>
<div id="howd-we-do" class="section level3 unnumbered">
<h3>How’d we do?</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bright Tree schedule</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bright_dates, <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">count_date</th>
<th align="left">week_day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">05-04-2023</td>
<td align="left">Thursday</td>
</tr>
<tr class="even">
<td align="left">05-11-2023</td>
<td align="left">Thursday</td>
</tr>
<tr class="odd">
<td align="left">05-18-2023</td>
<td align="left">Thursday</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fern Gully schedule</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fern_dates, <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">count_date</th>
<th align="left">week_day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">May 05, 2023</td>
<td align="left">Friday</td>
</tr>
<tr class="even">
<td align="left">May 12, 2023</td>
<td align="left">Friday</td>
</tr>
<tr class="odd">
<td align="left">May 19, 2023</td>
<td align="left">Friday</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Congrats!</strong></p>
<p>Your fine-tuned schedules worked perfectly.</p>
<p>Now let’s jump ahead and take a look at the survey results.</p>
<p><br></p>
</div>
</div>
<div id="results" class="section level2 unnumbered">
<h2>3. Results</h2>
<p><img src="../images/porgs_lifecycle.jpg" style="width:80.0%" /></p>
<div id="load-the-porg-survey-result." class="section level3 unnumbered">
<h3>Load the porg survey result.</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>porgs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.app/data/2022_porg_survey_results.csv&quot;</span>)   </span></code></pre></div>
<p><br></p>
<p><em>Explore a bit.</em></p>
<blockquote>
<p>Are there missing values?</p>
</blockquote>
<p><br></p>
</div>
<div id="a-missing-site" class="section level3 unnumbered">
<h3>A missing site</h3>
<p>It looks like we have a slight missing data problem.</p>
<p>There’s a data point in the results that wasn’t labeled with the site
location. We do know the date however.</p>
<p>On <code>2023-06-30</code> there were a whopping 7 porgs counted - but we just don’t know where.</p>
<p><br></p>
<p><strong>Can you determine the site based on the date of the porg count?</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mystery_site_date <span class="ot">&lt;-</span> <span class="st">&quot;2023-06-30&quot;</span></span></code></pre></div>
<blockquote>
<p><em>Hint: What weekday is this?</em></p>
<p>Try the <code>wday(date)</code> function.</p>
</blockquote>
<p><br></p>
<p><strong>Good sleuthing data droid.</strong></p>
<p>We’ll learn how to update the site value later today, but right now we’re in a hurry, so let’s remove the row using filter.</p>
<p>Use <code>filter()</code> to keep only the rows in the porgs data where <code>site</code> is <strong>NOT</strong> <em>NA</em> (missing).</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>porgs <span class="ot">&lt;-</span> <span class="fu">filter</span>(porgs, <span class="sc">!</span><span class="fu">is.na</span>(site))  </span></code></pre></div>
<p><br></p>
</div>
</div>
<div id="the-best-time-for-porgs" class="section level2 unnumbered">
<h2>4. The best time for porgs</h2>
<p><br></p>
<blockquote>
<h3 id="what-is-the-best-month-to-see-porgs" class="unnumbered">What is the best month to see porgs?</h3>
</blockquote>
<p><strong>First, add a <code>month</code> column to the data with the function <code>month()</code> and the column <code>count_date</code>.</strong></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>porgs <span class="ot">&lt;-</span> porgs <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(count_date))</span></code></pre></div>
<p><br></p>
<p><strong>Next, use <code>ggplot()</code> and <code>geom_col()</code> to plot the porg sightings by month.</strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porgs, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> ______ , <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>()</span></code></pre></div>
<details>
<summary class="btn_code">
Show code
</summary>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porgs, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> porg_count, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="/page/Day2_AM_files/figure-html/unnamed-chunk-39-1.png" width="960" /></p>
</details>
<p><br></p>
<blockquote>
<p>Why might June be the lowest month?</p>
<p><em>Hint:</em> Fern Gully</p>
</blockquote>
<p><br></p>
</div>
<div id="time-series---all-the-data" class="section level2 unnumbered">
<h2>5. Time series - All the data</h2>
<p>Plot all the data with <code>geom_point()</code>. Put <code>count_date</code> on the x-axis, and the <code>porg_count</code> on the y-axis. Set the color to match the <code>site</code> column.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porgs, <span class="fu">aes</span>(<span class="at">x =</span> _______, <span class="at">y =</span> ______ , <span class="at">color =</span> _____ )) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<details>
<summary class="btn_code">
Show code
</summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porgs, <span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> porg_count, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) </span></code></pre></div>
<p><img src="/page/Day2_AM_files/figure-html/unnamed-chunk-41-1.png" width="960" /></p>
</details>
<p><br></p>
<p>Oof! That’s a busy plot. Try adding <code>+ facet_wrap("site")</code> to the end.
What happens?</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porgs, <span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> porg_count, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">&quot;site&quot;</span>)   <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><br></p>
<p>Try adding <code>+ geom_line()</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porgs, <span class="fu">aes</span>(<span class="at">x =</span> count_date, <span class="at">y =</span> porg_count, <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> site) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()                <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><br></p>
<hr>
</div>
<div id="great-work" class="section level2 unnumbered">
<h2><i class="fas fa-party-horn" aria-hidden="true"></i> Great work</h2>
<p>The Ewoks were impressed and deeply thankful. They will be in touch for <em>Porg Survey 2024</em>.</p>
<p><img src="../images/porgs_4.jpg" style="width:35.0%" /></p>
</div>
</div>
<div id="pipe-things-together-a-b" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Pipe things together: <code>A %&gt;% B</code></h1>
<hr>
<p><br></p>
<blockquote>
<p><strong>Wishing you could type the name of the data less often?</strong></p>
</blockquote>
<p><img src="../images/pipe.png" style="margin-right: 20px; width: 136px; float: left; margin-top: 12px;" /></p>
<div id="you-can-with-the-pipe" class="section level3 unnumbered">
<h3>You can with the <em>pipe</em>!</h3>
<p>Use the <code>%&gt;%</code> to chain functions together and make our scripts more streamlined.</p>
<div style="clear: both;">

</div>
</div>
<div id="the-helps" class="section level2 unnumbered">
<h2>The <code>%&gt;%</code> helps:</h2>
<div id="eliminate-nested-parentheses" class="section level3 unnumbered">
<h3><strong><code>#1:</code></strong> <em>Eliminate nested parentheses</em></h3>
<p>Let’s say you have 3 numbers. Your analysis requires that you take the sum of them, then take the log of that result, and then round the final outcome.</p>
</div>
<div id="without-the-pipe" class="section level3 unnumbered">
<h3>Without the pipe <i class="fas fa-frown"></i></h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">log</span>(<span class="fu">sum</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>))))</span></code></pre></div>
<p><br></p>
<p>The code above is dense and we need to read it backwards from right to left to understand the order of operations. The pipe on the other hand allows us to read the code from left to right.</p>
</div>
<div id="with-the-pipe" class="section level3 unnumbered">
<h3>With the pipe <i class="fas fa-smile"></i></h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>) <span class="sc">%&gt;%</span> <span class="fu">sum</span>() <span class="sc">%&gt;%</span> <span class="fu">log</span>() <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span></code></pre></div>
<p><br></p>
</div>
<div id="combine-processing-steps-into-one-cohesive-chunk" class="section level3 unnumbered">
<h3><strong><code>#2:</code></strong> <em>Combine processing steps into one cohesive chunk</em></h3>
</div>
<div id="without-the-pipe-1" class="section level3 unnumbered">
<h3>Without the pipe</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">arrange</span>(scrap, <span class="fu">desc</span>(price_per_pound))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">filter</span>(scrap, origin <span class="sc">!=</span> <span class="st">&quot;All&quot;</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">mutate</span>(scrap, </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">scrap_finder    =</span> <span class="st">&quot;BB8&quot;</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure_method  =</span> <span class="st">&quot;REM-24&quot;</span>)</span></code></pre></div>
</div>
<div id="with-the-pipe-1" class="section level3 unnumbered">
<h3>With the pipe</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> scrap <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">arrange</span>(<span class="fu">desc</span>(price_per_pound)) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(origin <span class="sc">!=</span> <span class="st">&quot;All&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="at">scrap_finder    =</span> <span class="st">&quot;BB8&quot;</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">measure_method  =</span> <span class="st">&quot;REM-24&quot;</span>)</span></code></pre></div>
<p><br></p>
</div>
<div id="explore-1" class="section level3 unnumbered tip">
<h3><i class="fa fa-user-astronaut" style="color: green;"></i> Explore!</h3>
<p>Similar to above, use the <code>%&gt;%</code> to combine the two analysis lines below.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to only magnetic_field measurements</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>mag_endor <span class="ot">&lt;-</span> <span class="fu">filter</span>(air_endor, analyte <span class="sc">==</span> <span class="st">&quot;magnetic_field&quot;</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a date column to the filtered data</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>mag_endor <span class="ot">&lt;-</span> <span class="fu">mutate</span>(mag_endor, <span class="at">date =</span> <span class="fu">mdy</span>(start_run_date))</span></code></pre></div>
</div>
</div>
<div id="let-the-guide-you." class="section level2 unnumbered">
<h2>Let the <code>%&gt;%</code> guide you.</h2>
<p><br></p>
<blockquote>
<h2 id="wait.-so-wheres-finn" class="unnumbered">Wait…. <strong>So where’s Finn?</strong></h2>
</blockquote>
</div>
</div>
<div id="finn-needs-us" class="section level1 unnumbered">
<h1>Finn needs us!</h1>
<p>That’s enough <em>scuttlebutting</em> around, Finn needs us back on Jakku. We’re going to have to get better at our roll call procedure. Here we come Finn. <strong>Blast off!</strong></p>
<p><br></p>
<p><img src="../images/finn_run.gif" style="margin-left: 18%; width: 60%; margin-top: 6px;" /></p>
<p><br></p>
<p><br></p>
</div>
<div id="jakku-re-visited" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Jakku re-visited</h1>
<hr>
<p>Okay, so we’re back on this ol’ dust bucket planet. Let’s try not to forget anyone this time. Data droid, let me know if anyone goes missing.</p>
<div id="a-scrappy-ransom" class="section level2 unnumbered">
<h2>A scrappy ransom</h2>
<p>Mr. Baddy Plutt is demanding <strong>10,000 items</strong> of scrap for Finn. Sounds expensive, but lucky for us he didn’t clarify the exact items. Let’s find the scrap that weighs the least per shipment and try to make this transaction as light as possible.</p>
<p><br></p>
<div class="tip">
<h3 style="margin-top: 13px;">
Update from BB8!
</h3>
<p>BB8 was busy on our flight back to Jakku, and recovered a <strong>full</strong> set of scrap records from the notorious Unkar Plutt. Let’s take a look.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the full scrap database</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/starwars_scrap_jakku_full.csv&quot;</span>)</span></code></pre></div>
</div>
<p><br></p>
<p>Take a look at the <strong>NEW</strong> scrap data and see if we have the weight of all the items.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What unit types are in the data?</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scrap<span class="sc">$</span>units)</span></code></pre></div>
<pre><code>## [1] &quot;Cubic Yards&quot; &quot;Items&quot;       &quot;Tons&quot;</code></pre>
<p><br></p>
<p><strong>Or return results as a data frame</strong></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(scrap, units)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   units      
##   &lt;chr&gt;      
## 1 Cubic Yards
## 2 Items      
## 3 Tons</code></pre>
<p><br></p>
<p><em>Hmmm….</em> So how much does a cubic yard of <code>Hull Panel</code> weigh?</p>
<p><em>A lot? 32? Maybe…</em></p>
<p>I think we’re going to need some more data.</p>
<p><br></p>
<div class="tip">
<p><strong>“Hey BB8!”</strong></p>
<p><strong>“Do your magic data finding thing.”</strong></p>
</div>
</div>
<div id="weight-conversion" class="section level2 unnumbered">
<h2>Weight conversion</h2>
<p><img src="../images/rey_bb8.jpg" align="right" style="width: 35%; margin-top: 0px; margin-left: 15px; margin-right: 0px;" /></p>
<p>It took a while, but with a few droid bribes BB8 was able to track down a <em>Weight conversion table</em> from his droid buddies. Our current data shows the total cubic yards for some scrap shipments, but not how much the shipment weighs.</p>
<div id="read-the-weight-conversion-table" class="section level3 unnumbered">
<h3>Read the weight conversion table</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The data&#39;s URL</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>convert_url <span class="ot">&lt;-</span> <span class="st">&quot;https://rtrain.netlify.com/data/conversion_table.csv&quot;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the conversion data</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>convert <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(convert_url)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(convert, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   item               units       pounds_per_unit
##   &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
## 1 Bulkhead           Cubic Yards             321
## 2 Hull Panel         Cubic Yards             641
## 3 Repulsorlift array Cubic Yards             467</code></pre>
<p><br></p>
<p>Oh my stars! A cubic yard of <code>Hull Panel</code> weighs <strong>641 lbs</strong>. I knew it!</p>
<p>Let’s join this new conversion table to the scrap data to make our calculations easier. To do that we need to meet a new function.</p>
<p><strong>Say Hello to our friend <code>left_join()</code>!</strong></p>
<p><br></p>
</div>
</div>
</div>
<div id="join-tables-with-left_join" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Join tables with <strong>left_join</strong></h1>
<hr>
<div id="joining-2-tables" class="section level2 unnumbered">
<h2>Joining 2 tables</h2>
<p><img src="../images/leftjoin_scrap.png" style="width: 55%; margin-left: 18%; margin-bottom: 12px;" /></p>
<blockquote>
<h4 id="left_joinscrap-convert-by-ccolumns-to-join-by" class="unnumbered"><code>left_join(scrap, convert, by = c("columns to join by"))</code></h4>
</blockquote>
<p><br></p>
<p>Left join works like a zipper to combine 2 tables based on one or more variables. It’s called “left”-join because the entire table on the left side is retained.</p>
<p>Anything that matches from the right table gets to join the party, but any rows that don’t have a matching ID will be ignored.</p>
<p><br></p>
<div id="adding-porg-names" class="section level3 unnumbered">
<h3>Adding porg names</h3>
<p>Remember our porg friends? How rude of us not to share their names.</p>
<p>Here’s a table of their names.</p>
<div style="margin-left: 30px; margin-top: 24px; width: 37%; max-width: 37%; margin-bottom: 22px;">
<p><img src="../images/porgs/porg_names_tbl.png" /></p>
</div>
<blockquote>
<p><strong>But who’s who?</strong> Let’s join their names to the rest of the data based on the <code>ID</code> column.</p>
</blockquote>
<p><img src="../images/porgs/leftjoin_porgs.png" style="width: 90%; max-width: 85%;" /></p>
<p><br></p>
</div>
<div id="the-joined-table" class="section level3 unnumbered">
<h3><strong>The joined table</strong></h3>
<div class="well">
<p><img src="../images/porgs/porgs_and_names.png" style="width: 85%; max-width: 85%;" /></p>
</div>
<p><br></p>
<details>
<summary class="btn_code_blue">
<span style="color: #f6cd00;"><i class="fas fa-star"></i><strong>BONUS</strong><i class="fas fa-star"></i></span> <strong>More joining</strong>
</summary>
<div class="note" style="margin-top: -10px;">
<p>
<div id="star-wars-characters" class="section level3 unnumbered">
<h3>Star Wars characters</h3>
<p><strong>left_join()</strong> adds columns to your table by pulling them from another table. Imagine you have the 2 Star Wars tables below. One table includes character names and heights; the second has names and homeworlds. Since both tables share a common name column, we can join the tables together using the name columns as the joining key.</p>
<style type="text/css"> 
.table {width: 30%;} 
</style>
<p><br></p>
<div style="float: left;">
<p><code>starwars_heights</code></p>
<table>
<thead>
<tr class="header">
<th align="left">starwars_name</th>
<th align="right">height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="right">202</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="left">Greedo</td>
<td align="right">246</td>
</tr>
</tbody>
</table>
</div>
<div style="float: left; margin-left: 15%;">
<p><code>starwars_homeworlds</code></p>
<table>
<thead>
<tr class="header">
<th align="left">starwars_name</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="left">Alderaan</td>
</tr>
<tr class="odd">
<td align="left">Ayla Secura</td>
<td align="left">Ryloth</td>
</tr>
</tbody>
</table>
</div>
<div style="clear: both;">

</div>
<p><br></p>
<p><strong>Uh oh.</strong> There’s no “Ayla Secura” in the height table and there’s no “Greedo” in the homeworld table. Can we still join the tables? Run the code below to see what happens.</p>
<p><br></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new tables </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>starwars_heights <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">starwars_name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Greedo&quot;</span>), </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">202</span>, <span class="dv">150</span>, <span class="dv">246</span>))      </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>starwars_homeworlds <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">starwars_name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Ayla Secura&quot;</span>), </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">homeworld =</span> <span class="fu">c</span>(<span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Alderaan&quot;</span>, <span class="st">&quot;Ryloth&quot;</span>))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the tables together by starwars_name</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Tell left_join which columns to use as the key with:  </span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     by = c(&quot;key_left&quot; = &quot;key_right&quot;)</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>height_and_homeworld <span class="ot">&lt;-</span> <span class="fu">left_join</span>(starwars_heights, starwars_homeworlds, </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;starwars_name&quot;</span> <span class="ot">=</span> <span class="st">&quot;starwars_name&quot;</span>))</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>height_and_homeworld</span></code></pre></div>
<p><br></p>
<table>
<thead>
<tr class="header">
<th align="left">starwars_name</th>
<th align="right">height</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="right">202</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="right">150</td>
<td align="left">Alderaan</td>
</tr>
<tr class="odd">
<td align="left">Greedo</td>
<td align="right">246</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p><br></p>
<div id="did-it-work" class="section level4 unnumbered">
<h4>Did it work?</h4>
<p>When <strong>left_join</strong> adds the <code>homeworlds</code> column to the <em>starwars_heights</em> table it only adds a value for the characters when the tables have a matching character name. When R couldn’t find “Greedo” in the homeworld table, the Star Wars character’s homeworld was recorded as missing or <em><code>NA</code></em>.</p>
<p><br></p>
</div>
</div>
<div id="multiple-records" class="section level3 unnumbered">
<h3>Multiple records</h3>
<div>
<p><img src="../images/c3po.png" style="width: 13%; float: left; margin-top: 12px; margin-right: 4px;" /> <img src="../images/c3po.png" style="width: 13%; float: left; margin-top: 12px; margin-right: 28px;" /></p>
</div>
<p><br></p>
<p>Now imagine the table <code>starwars_homeworld</code> has two records for C-3PO, each with a different homeworld listed.</p>
<p>What will happen when you join the two tables?</p>
<div style="clear: both;">
<br>
</div>
<div style="float: left;">
<p><code>starwars_heights</code></p>
<table>
<thead>
<tr class="header">
<th align="left">starwars_name</th>
<th align="right">height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="right">202</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="left">Greedo</td>
<td align="right">246</td>
</tr>
</tbody>
</table>
</div>
<div style="float: left; margin-left: 15%;">
<p><code>starwars_homeworlds</code></p>
<table>
<thead>
<tr class="header">
<th align="left">starwars_name</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">C-3PO</td>
<td align="left">Tantive IV</td>
</tr>
<tr class="even">
<td align="left">Darth Vader</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Leia Organa</td>
<td align="left">Alderaan</td>
</tr>
<tr class="even">
<td align="left">Ayla Secura</td>
<td align="left">Ryloth</td>
</tr>
</tbody>
</table>
</div>
<div style="clear: both;">

</div>
<p><br></p>
<p>When you run the code below you’ll see that <strong>left_join</strong> is very thorough and adds each additional homeworld it finds for <em>C-3PO</em> as a new row in the joined table.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new tables </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>starwars_heights <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">starwars_name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Greedo&quot;</span>), </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">height  =</span> <span class="fu">c</span>(<span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">202</span>, <span class="dv">150</span>, <span class="dv">173</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>starwars_homeworlds <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">starwars_name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Ayla Secura&quot;</span>), </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">homeworld =</span> <span class="fu">c</span>(<span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tantive IV&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Alderaan&quot;</span>, <span class="st">&quot;Ryloth&quot;</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the tables together by Star Wars character name</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>height_and_homeworld <span class="ot">&lt;-</span> <span class="fu">left_join</span>(starwars_heights, starwars_homeworlds)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check number of rows</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(height_and_homeworld)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>height_and_homeworld</span></code></pre></div>
<p><br></p>
<table>
<thead>
<tr class="header">
<th align="left">starwars_name</th>
<th align="right">height</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">C-3PO</td>
<td align="right">167</td>
<td align="left">Tantive IV</td>
</tr>
<tr class="even">
<td align="left">Darth Vader</td>
<td align="right">202</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Leia Organa</td>
<td align="right">150</td>
<td align="left">Alderaan</td>
</tr>
<tr class="even">
<td align="left">Greedo</td>
<td align="right">173</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="blockquote">
<p>This results in a table with one extra row than we started with in our heights table. So growing table sizes are a sign of duplicate records when using <strong>left_join()</strong>.</p>
<p>In practice, when you see this you’ll want to investigate why one of your tables has duplicate entries, especially if the observations for the two rows are different – as it was for <em>C-3PO’s</em> homeworld.</p>
<p>Are there really two different Star Wars characters named <em>C-3PO</em>, or did someone make two different guesses about the droid’s homeworld? Or maybe the data simply has a mistake? It happens.</p>
</div>
</p>
</div>
</div>
</details>
<style type="text/css"> 
.table {width: auto;} 
</style>
<p><br></p>
</div>
</div>
<div id="back-to-the-scrap-yard" class="section level2 unnumbered">
<h2>Back to the scrap yard</h2>
<hr class="hrlvl2">
<p>Let’s apply our new <code>left_join()</code> skills to the scrap data.</p>
<p>First, let’s re-read the full scrap data.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the larger scrap database</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/starwars_scrap_jakku_full.csv&quot;</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># what units types are in the data? </span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(scrap, units)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   units      
##   &lt;chr&gt;      
## 1 Cubic Yards
## 2 Items      
## 3 Tons</code></pre>
<div id="join-the-conversion-table-to-scrap" class="section level3 unnumbered">
<h3>Join the conversion table to scrap</h3>
<p>Look at the tables. What columns in both tables do we want to join <strong>by</strong>?</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(scrap)</span></code></pre></div>
<p>Let’s join by <code>item</code> and <code>units</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the scrap to the conversion table</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">left_join</span>(scrap, convert, </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;item&quot;</span>  <span class="ot">=</span> <span class="st">&quot;item&quot;</span>, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;units&quot;</span> <span class="ot">=</span> <span class="st">&quot;units&quot;</span>))</span></code></pre></div>
<p><br></p>
<blockquote>
<p><strong>Want to save on typing?</strong></p>
</blockquote>
<p><code>left_join()</code> will automatically search for matching columns if you don’t use the <code>by=</code> argument. So if you know 2 tables share a column name you don’t have to specify how to join them. The code below does the same as above.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">left_join</span>(scrap, convert)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scrap, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 8
##   receipt_date item                  origin desti…¹ amount units price…² pound…³
##   &lt;chr&gt;        &lt;chr&gt;                 &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 4/1/2013     Bulkhead              Crate… Raiders   4017 Cubi…   1005.     321
## 2 4/2/2013     Starship sensor array Outsk… Trade …   1249 Cubi…   1129.     637
## 3 4/3/2013     Starship sensor array Outsk… Niima …   4434 Cubi…   1129.     637
## 4 4/4/2013     Hull Panel            Crate… Raiders    286 Cubi…    843.     641
## # … with abbreviated variable names ¹​destination, ²​price_per_pound,
## #   ³​pounds_per_unit</code></pre>
<div id="help" class="section level4 unnumbered quiz">
<h4><strong>Help!</strong></h4>
<p>For more details on the <strong>join</strong> family of functions, you can type <code>?left_join</code> to see all the arguments and options.
<br></p>
</div>
</div>
</div>
<div id="total-pounds-per-shipment" class="section level2 unnumbered">
<h2>Total pounds per shipment</h2>
<hr class="hrlvl2">
<p>Let’s <code>mutate()</code>!</p>
<p>Now that we have pounds per unit we can use <code>mutate</code> to calculate the total pounds for each shipment.</p>
<p><strong>Fill in the blank</strong></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> scrap <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">total_pounds =</span> amount <span class="sc">*</span>  _____________ )</span></code></pre></div>
<details>
<summary class="btn_code">
<em>Show code</em>
</summary>
<p>
<div class="quiz" style="margin-top: -6px;">
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> scrap <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">total_pounds =</span> amount <span class="sc">*</span> pounds_per_unit)</span></code></pre></div>
</div>
</p>
</details>
</div>
<div id="total-price-per-shipment" class="section level2 unnumbered">
<h2>Total price per shipment</h2>
<div id="explore-2" class="section level3 unnumbered tip">
<h3><i class="fa fa-user-astronaut" style="color: green;"></i> Explore!</h3>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="totalprice-tab" data-toggle="tab" href="#totalprice" role="tab" aria-controls="totalprice" aria-selected="true">Total price</a>
</li>
<li class="nav-item">
<a class="nav-link" id="showhint-tab" data-toggle="tab" href="#showhint" role="tab" aria-controls="showhint" aria-selected="false">Show hint</a>
</li>
<li class="nav-item">
<a class="nav-link" id="showcode-tab" data-toggle="tab" href="#showcode" role="tab" aria-controls="showcode" aria-selected="false">Show code</a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="totalprice" class="tab-pane fade active in" role="tabpanel" aria-labelledby="totalprice-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">
# Calculate the total price for each shipment
scrap <- scrap %>% 
         mutate(credits = ________ * ________ )
         
</pre>
</div>
<div id="showhint" class="tab-pane fade" role="tabpanel" aria-labelledby="showhint-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">
# Calculate the total price for each shipment
scrap <- scrap %>% 
         mutate(credits = total_pounds  * ________ )

</pre>
</div>
<div id="showcode" class="tab-pane fade" role="tabpanel" aria-labelledby="showcode-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">
# Calculate the total price for each shipment
scrap <- scrap %>% 
         mutate(credits = total_pounds * price_per_pound)
         
</pre>
</div>
</div>
</div>
<p><br></p>
</div>
<div id="price-per-item" class="section level2 unnumbered">
<h2>Price per item $</h2>
<p><strong>Great!</strong> Let’s add one last column. We can divide the shipment’s <em>credits</em> by the <em>amount</em> of items to get the <code>price_per_unit</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the price per unit</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> scrap <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">price_per_unit =</span> credits <span class="sc">/</span> amount)</span></code></pre></div>
<p><br></p>
<div id="teaser" class="section level3 unnumbered note" style="line-height: 1.6;">
<h3>Teaser</h3>
<p>Analysts often get asked questions:</p>
<ul>
<li>What’s the highest number?</li>
<li>What’s the lowest number?</li>
<li>What was the average tons of scrap from Cratertown last year?</li>
<li>Which town’s scrap was worth the most credits?</li>
</ul>
</div>
<p><br></p>
<div id="return-to-homebase" class="section level3 unnumbered">
<h3><i class="fa fa-rocket" aria-hidden="true"></i> Return to <a href="../post/day-2.html">Homebase</a></h3>
<p><br></p>
</div>
</div>
</div>
